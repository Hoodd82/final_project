
```{r}
flights_test <- flights %>% 
  drop_na() %>% # drop NAs since these observations will not be useful in the analysis
  mutate(depart_date = str_c(year, month, day, sep = "-")) %>%
  mutate(across(.cols = c(dep_time, sched_dep_time, arr_time, sched_arr_time), 
                .fns = ~ str_pad(.x, width = 4, pad = 0))) %>% # convert the time variables to hhmm
  mutate(across(.cols = c(dep_time, sched_dep_time, arr_time, sched_arr_time), 
                .fns = ~ str_replace(.x, "^(..)", "\\1:"))) %>%
  mutate(sched_depart_datetime = ymd_hm(paste(depart_date, sched_dep_time))) %>%
  mutate(act_depart_datetime = sched_depart_datetime + dep_delay * 60) %>%
  relocate(sched_depart_datetime, act_depart_datetime)


flights_test
```

